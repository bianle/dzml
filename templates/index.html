<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript" src="../static/js/jquery.js"></script>

<style>
*{
	font-family:Berlin Sans FB
}
body{
	width:100%;
      float: left;
      
      margin: 0px;
      
      -webkit-background-size: 50px 50px;
      -moz-background-size: 50px 50px;
      background-size: 50px 50px; /* Controls the size of the stripes */
      
      -moz-box-shadow: 1px 1px 8px gray;
      -webkit-box-shadow: 1px 1px 8px gray;
      box-shadow: 1px 1px 8px gray;
	  
	  background-color: #ac0;
      background-image: -webkit-gradient(linear, 0 100%, 100% 0,
                  color-stop(.25, rgba(255, 255, 255, .2)), color-stop(.25, transparent),
                  color-stop(.5, transparent), color-stop(.5, rgba(255, 255, 255, .2)),
                  color-stop(.75, rgba(255, 255, 255, .2)), color-stop(.75, transparent),
                  to(transparent));
      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, .2) 25%, transparent 25%,
                transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%,
                transparent 75%, transparent);
      background-image: -moz-linear-gradient(45deg, rgba(255, 255, 255, .2) 25%, transparent 25%,
                transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%,
                transparent 75%, transparent);
      background-image: -ms-linear-gradient(45deg, rgba(255, 255, 255, .2) 25%, transparent 25%,
                transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%,
                transparent 75%, transparent);
      background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, .2) 25%, transparent 25%,
                transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%,
                transparent 75%, transparent);
      background-image: linear-gradient(45deg, rgba(255, 255, 255, .2) 25%, transparent 25%,
                transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%,
                transparent 75%, transparent);
}
.ipt{
	height:30px;
	width:300px;
	
}
.btn{
	height:30px;
}
.rst{
	font-size:30px;
	border:1px dotted #F0F0F0;
	color:#F0F0F0;
	width:420px;
	margin:0 auto;
}
</style>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="main" style="height:500px;">
	
	<div class="shorter" style="text-align:center;margin:auto;">
		<div style="color:#222;font-weight:bold;font-size:50px;margin:50px 0 5px 0;"><a>DZM.LA</a>&nbsp;</div>
		<div style="color:#F0F0F0;font-size:18px;">~ Make your url shorter! ~</div>
		<div style="width:100%;margin:100px 0 20px 0;padding:0px;text-align:center;">
			<span style="font-size:30px;">â˜ž</span>
			<input class="ipt"  id="longUrl" type="text"  />
			<input class="btn" id='cutBtn' type="button" value="->||<-"  />
			<input class="btn" id="recoverBtn" type="button" value="|<---->|"/>
			
			
			
			
		</div>
		<br/>
		<div>
			
		</div>
		
		<div class="rst" id="rst" style="display:none;" onclick="selectText()"></div>
	</div>
	
</div>

<div style="text-align:center;margin:10px 0 0 0;font-size:16px;color:#f0f0f0">&copy;2015 dzm.la <a href="https://github.com/bianle" target="_blank">@bianle</a></div>
<script>
	function selectText(){
		if (document.selection) {
			var range = document.body.createTextRange();
			range.moveToElementText(document.getElementById('rst'));
			range.select();
		} else if (window.getSelection) {
			var range = document.createRange();
			range.selectNode(document.getElementById('rst'));
			window.getSelection().addRange(range);
		}
	}

	(function(jj){
	jj('#cutBtn').click(function(){
	cut();
	});
	jj("#recoverBtn").click(function(){
	recover();
	});

	function cut(){
	jj('#cutBtn').unbind('click');
	lurl = jj('#longUrl').val();
	jj.ajax({
	url:'/s/url/',
	data:{u:lurl},
	type:'post',
	dataType:'text',
	success:function(data){
	jj('#rst').html('http://dzm.la/'+data);
	jj('#rst').show();
	jj('#cutBtn').bind('click',cut);
	}
	});
	}

	function recover(){
	jj("#recoverBtn").unbind('click');
	var key = jj('#longUrl').val().replace(/\//g,'').slice(-5);
	
	jj.ajax({
	url:'/s/url/'+key,
	data:{},
	type:'get',
	dataType:'text',
	success:function(data){
	jj('#rst').html(data);
	jj("#recoverBtn").bind('click',recover);
	}
	});
	
	}
	
	})(jQuery)
	
</script>
</body>
</html>
